\documentclass[xcolor={dvipsnames,rgb},aspectratio=1610]{beamer}
% xcolor: e.g. provides \colorlet
% dvipsnames option: extra named colours
% aspectratio=1610: for modern widescreen monitors...
% see https://www.overleaf.com/learn/latex/Using_colours_in_LaTeX for more detail

% equation annotations also work in articles, of course (then might need explicit \usepackage[dvipsnames]{xcolor}

%%% standard math packages for equations:
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}

%%% tikz & libraries
\usepackage{tikz}
\usetikzlibrary{backgrounds}
\usetikzlibrary{arrows,shapes}
\usetikzlibrary{tikzmark} % for \tikzmarknode
\usetikzlibrary{calc} % for computing the midpoint between two nodes, e.g. at ($(p1.north)!0.5!(p2.north)$) 

\newcommand{\eqnhighlightbox}[2]{%
% \colorbox sets the second argument in text mode, so for use within equations we wrap it in $ $ again
    \mathchoice% to get right font size in each mode:
        {\colorbox{#1}{$\displaystyle #2$}}%
        {\colorbox{#1}{$\textstyle #2$}}%
        {\colorbox{#1}{$\scriptstyle #2$}}%
        {\colorbox{#1}{$\scriptscriptstyle #2$}}%
}

\newcommand{\eqnhighlightheight}{}  % colorbox will shrink to content
\renewcommand{\eqnhighlightheight}{\mathstrut} % colorbox will always have full height

\newcommand{\eqnhighlightshade}{17}  % light
\renewcommand{\eqnhighlightshade}{47}  % dark

\newcommand{\eqnannotationtext}[1]{\textsf{\footnotesize\strut #1}}

\newcommand{\eqnhighlight}[2]{\eqnhighlightbox{#1!\eqnhighlightshade}{\eqnhighlightheight #2}}

\colorlet{defaulthighlight}{black}
\newcommand{\eqnmarkbox}[3][defaulthighlight]{\addvalue{#2}{#1}\tikzmarknode{#2}{\eqnhighlight{#1}{#3}}}
\newcommand{\eqnmark}[3][defaulthighlight]{\addvalue{#2}{#1}\tikzmarknode{#2}{{\color{#1}#3}}}

\newcounter{eqnannotatenode}
\newcommand*{\eqnannotateCurrentNode}{eqnannotatenode\theeqnannotatenode}

% from https://tex.stackexchange.com/a/48931/171664 :
\def\addvalue#1#2{\expandafter\gdef\csname eqnannotate@data@#1\endcsname{#2}}
\def\usevalue#1{\csname eqnannotate@data@#1\endcsname}

% for pgfkeys, see https://tex.stackexchange.com/a/34318/171664

\newcommand{\swapNorthSouth}[1]{%
    \ifnum\pdfstrcmp{#1}{south}=0 north\else south\fi
}

% manually adjust \node's yshift until it's at appropriate distance above the equation
% can add xshift as well, if needed (also positive or negative)
\newcommand{\annotatetwoAt}[6]{%
    % 1. extra args for \node e.g. yshift=...
    % 2. color
    % 3. node1
    % 4. node2
    % 5. text
    % 6. anchor for annotation text and line, should be "north" for above and "south" for below
    \stepcounter{eqnannotatenode}%
    \begin{tikzpicture}[overlay,remember picture,>=stealth,nodes={align=left,inner ysep=1pt},<-]
        % default anchor is at center
        \node[anchor=\swapNorthSouth{#6},color=#2!85,#1]  % color #2 blended with white to 85%, any (optional) extra args #1
            (\eqnannotateCurrentNode)   % use counter-based "local node"
            at ($(#3.#6)!0.5!(#4.#6)$)  % centered between node1 (#3) and node2 (#4), with anchor #6 each
            {\eqnannotationtext{#5}};   % text from #5
        % double arrow to two uses within the equation:
        \draw [<->,color=#2] (#3.#6) |- ([yshift=0.1ex] \eqnannotateCurrentNode.south) -| (#4.#6);  % from node1 (#3) via annotation to node2 (#4), with anchor #6 each
    \end{tikzpicture}%
}

% [1.] extra args for \node e.g. yshift=...
% 2. color
% 3. node1
% 4. node2
% 5. text
\newcommand{\annotatetwoabove}[5][]{\annotatetwoAt{#1}{#2}{#3}{#4}{#5}{north}}
\newcommand{\annotatetwobelow}[5][]{\annotatetwoAt{#1}{#2}{#3}{#4}{#5}{south}}

\newcommand{\annotateAtRight}[5][]{%
    % [1.] extra args for \node e.g. yshift=...
    % 2. color
    % 3. node
    % 4. text
    % 5. anchor for annotation text and line, should be "north" for above and "south" for below
    \stepcounter{eqnannotatenode}%
    \begin{tikzpicture}[overlay,remember picture,>=stealth,nodes={align=left,inner ysep=1pt},<-]
        \node[anchor=\swapNorthSouth{#5} west,color=\usevalue{#3}!85,#1]
                % anchor=west: align left edge of text on top of tikzmark in equation
                % should be north west for below and south west for above ...
            (\eqnannotateCurrentNode) at (#3.#5)  % above mark
            {\eqnannotationtext{#4}};
        \draw [color=#2] (#3.#5)  % arrow from the equation
                % this one is above the equation: start at north anchor of mark
            |- ([xshift=-0.3ex,yshift=0.1ex] \eqnannotateCurrentNode.south east);
                % - south east: we want line to end at bottom right of annotation text;
                % - negative xshift makes it a little bit shorter;
                % - yshift for aesthetics (\strut is ever so slightly too tall).
    \end{tikzpicture}%
}
\newcommand{\annotateAboveRight}[4][]{\annotateAtRight[#1]{#2}{#3}{#4}{north}}
\newcommand{\annotateBelowRight}[4][]{\annotateAtRight[#1]{#2}{#3}{#4}{south}}

\begin{document}

\begin{frame}{Runtime complexity}
    \LARGE %%% increase font size to make equation more readable!

    %%% we define our own colors upfront - this makes it easier to keep it consistent if you change your mind
    \colorlet{colorp}{NavyBlue}
    \colorlet{colorT}{WildStrawberry}
    \colorlet{colork}{OliveGreen}
    \colorlet{colorM}{RoyalPurple}
    \colorlet{colorNb}{Plum}
    \colorlet{colorIs}{black}

    \begin{equation*}
        \mathcal{O}\big(
            (
            % \tikzmarknode is what links parts of the equation and corresponding annotations
            \eqnmarkbox[colorp]{p1}{p}
            \eqnmarkbox[colork]{k1}{\kappa}^3 % note that we have the ^3 outside the \tikzmarknode
            )
            \eqnmarkbox[colorT]{T1}{T}
            +
            (
            \eqnmarkbox[colorp]{p2}{p} % tikzmarks need distinct names!
            \eqnmarkbox[colork]{k2}{\kappa}
            )
            (
            \eqnmarkbox[colorT]{T2}{T}^2
            \eqnmark[colorIs]{Is}{|\mathcal{I}^*|}
            \eqnmarkbox[colorNb]{Nb}{N_b}
            \eqnmarkbox[colorM]{M}{M}
            )
        \big)
    \end{equation*}
    \annotatetwoabove[yshift=1em]{colorp}{p1}{p2}{\# of nodes}
    \annotatetwobelow[yshift=-1em,xshift=0.2ex]{colorT}{T1}{T2}{\# of graphs in $\hat{\mathcal{G}}_T$}
    \annotatetwobelow[yshift=-2em]{colork}{k1}{k2}{max.\ indegree in $\hat{\mathcal{G}}_T$}
    \annotateAboveRight[yshift=3em]{colorIs}{Is}{size of set of allowed interventions}
    \annotateAboveRight[yshift=1em]{colorNb}{Nb}{\# of samples per batch}
    \annotateBelowRight[yshift=-1em]{colorM}{M}{\# of samples for $\mathbb{E}_y$}
\end{frame}

\end{document}
